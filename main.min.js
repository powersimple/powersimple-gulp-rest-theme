var menu_config={"top-menu":{menu_type:"wheel",location:"#main-menu",callback:"circleMenu"}},increment="vw",_w=jQuery(window).width(),_h=jQuery(window).height();function reposition_screen(){_h<_w?(jQuery(".phi-centered").css("width","61.8vh"),jQuery(".phi-centered").css("height","61.8vh"),jQuery(".phi-centered").css("margin-left","-30.9vh"),jQuery(".phi-centered").css("margin-top","-30.9vh"),jQuery("#main-nav").css("width","80vh"),jQuery("#main-nav").css("height","80vh"),jQuery("#main-nav").css("margin-left","-40vh"),jQuery("#main-nav").css("margin-top","-40vh")):(jQuery(".phi-centered").css("width","61.8vw"),jQuery(".phi-centered").css("height","61.8vw"),jQuery(".phi-centered").css("margin-left","-29.9vw"),jQuery(".phi-centered").css("margin-top","-30.9vw"),jQuery("#main-nav").css("width","80vw"),jQuery("#main-nav").css("height","80vw"),jQuery("#main-nav").css("margin-left","-40vw"),jQuery("#main-nav").css("margin-top","-40vw")),jQuery("#stars").css("height","100vh"),jQuery("#stars").css("width","100vw")}function circleMenu(t){var e=document.querySelectorAll(t);console.log(_w,_h,increment);for(var i=0,s=e.length;i<s;i++){var n=Math.cos(-.5*Math.PI-1/s*2*i*Math.PI);e[i].style.left=50-36*n+increment;var o=Math.sin(-.5*Math.PI-1/s*2*i*Math.PI);e[i].style.top=50+35*o+increment}document.querySelector(".menu-button").onclick=function(t){t.preventDefault(),document.querySelector(".circle").classList.toggle("open")}}function displayPage(t,e){var s="";if(0<e.length){for(s="<ul class='nav_project'>",i=0;i<post_ids.length;i++)displayProjectCard(e[i]);s+="</ul>"}jQuery("#project-nav").html(s)}function displayPosts(t,e){var s="";if(0<e.length){for(s="<ul class='nav_project'>",i=0;i<post_ids.length;i++)displayProjectCard(e[i]);s+="</ul>"}jQuery(t).html(s)}function displayProjects(t,e){var s="";if(0<e.length){for(s="<ul class='nav_project'>",i=0;i<post_ids.length;i++)displayProjectCard(e[i]);s+="</ul>"}jQuery("#project-nav").html(s)}function displayProjectCard(t){var e=posts[t];console.log("project",t,e);var i='<li class="project-card">';return i+=e.title,i+="</li>"}function menu_order(t,e){return t.menu_order<e.menu?-1:t.menu_order>e.menu_order?1:0}function displayMenus(){var t=[];for(var e in menus)if(null!=menu_config[e]){for(var i in menu_array=[],menus[e].items)0==menus[e].items[i].parent&&menu_array.push(menus[e].items[i]);menu_array.sort(menu_order),console.log("menu_array",menu_array);for(var s=[],n=0;n<menu_array.length;n++){s=[];for(var o=0;o<menu_array[n].children.length;o++)s.push({title:menus[e].items[menu_array[n].children[o]].title,id:menus[e].items[menu_array[n].children[o]].id,children:menus[e].items[menu_array[n].children[o]].children});t.push({title:menu_array[n].title,id:menu_array[n].id,children:s})}jQuery(menu_config[e].location).html(""),"wheel"==menu_config[e].menu_type&&makeWheelNav("WebSlice",t)}}function displayTags(t,e){for(var i in e);}function displayCategories(t,e){var i="<ul class='nav_cat'>";for(var s in e)i+=navTab(e[s]);i+="</ul>",jQuery(t).html(i)}jQuery(document).ready(function(){reposition_screen()}),jQuery(window).resize(function(){_w=jQuery(window).width(),_h=jQuery(window).height(),increment=_h<_w?"vh":"vw",reposition_screen()}),jQuery("#logo").on("click",function(t){t.preventDefault()}),jQuery("#portfolio").on("click",".nav__item",function(){var t=jQuery(this).data("id");displayProjects(categories[t].category_posts)});var posts={},categories={},tags={},menus={};function getREST(t,e,s,n){var i="/wp-json/wp/v2/"+t;console.log("endpoint",i),jQuery.ajax({url:i,data:e,success:function(t,e,i){return s(t,n)},error:function(t,e,i){console.log(t.responseText)},cache:!1})}function setPosts(t,e){for(var i="post",s=0;s<t.length;s++)void 0!==t[s].title&&void 0!==t[s].title.rendered&&(t[s].title=t[s].title.rendered),void 0!==t[s].content&&void 0!==t[s].content.rendered&&(t[s].content=t[s].content.rendered),void 0!==t[s].type&&(i=t[s].type,posts[t[s].id]=t[s]);if(void 0!==i)switch(i){case i="project":case i="post":case i="page":displayProjects(e,posts)}return console.log(i,posts),posts}function setMenuItem(t){return this_item={},this_item.id=t.ID,this_item.title=t.title,this_item.menu_order=t.menu_order,this_item.object=t.object,this_item.parent=t.menu_item_parent,this_item.children=[],this_item}function setMenu(t,e){menu={};for(var i=0;i<e.length;i++)menu[e[i].ID]=setMenuItem(e[i]),0!=e[i].menu_item_parent&&menu[e[i].menu_item_parent].children.push(e[i].ID);return menu}function setMenus(t,e){console.log("raw menu data",t);for(var i=0;i<t.length;i++)menus[t[i].slug]={},menus[t[i].slug].name=t[i].name,menus[t[i].slug].items=setMenu(t[i].slug,t[i].items);console.log("MENUS",menus),displayMenus()}function setChildCategories(t,e){for(var i=0;i<t.length;i++)categories[t[i].id]=t[i];return displayCategories(e,categories),t}function setTags(t,e){for(var i=0;i<t.length;i++)tags[t[i].id]=t[i];return displayTags(e,tags),t}function navTab(t){var e="";return e+="<li data-id="+t.id+" class='nav__item'>",e+="<span>",e+=t.name,e+="</span>",e+="</li>"}getREST("posts","fields=id,type,title,content,slug,excerpt,thumbnail_url,project_info,thumbnail_versions,featured_video,type",setPosts,"#posts"),getREST("pages","fields=id,type,title,content,slug,excerpt,thumbnail_url,project_info,thumbnail_versions,featured_video,type",setPosts,"#pages"),getREST("project","fields=id,type,title,content,slug,excerpt,thumbnail_url,project_info,thumbnail_versions,featured_videotype",setPosts,"#projects"),getREST("categories","parent=19&fields=id,name,count,slug,description,category_posts",setChildCategories,"#category-menu"),getREST("tags","fields=id,name,slug,tag_posts",setTags,"tags"),getREST("menus","",setMenus,"#main-menu"),function(o){"use strict";var a,r;(a=function(t,e,i,s){this.obj=t,this.options=t.options,this.name=e,this.href=s.href,s.url&&(this.url=s.url),this.el=o('<a href="'+this.href+'">'+this.name+"</a>").addClass("node"),o("body").prepend(this.el),i?t.lines[t.lines.length]=new r(t,this,i):(t.activeNode=this).el.addClass("active root"),this.parent=i,this.children=[],this.parent&&this.parent.children.push(this),this.moving=!1,this.moveTimer=0,this.obj.movementStopped=!1,this.visible=!0,this.x=1,this.y=1,this.dx=0,this.dy=0,this.hasPosition=!1,this.content=[],this.el.css("position","absolute");var n=this;this.el.draggable({drag:function(){t.root.animateToStatic()}}),this.el.click(function(){return t.activeNode&&(t.activeNode.el.removeClass("active"),t.activeNode.parent&&t.activeNode.parent.el.removeClass("activeparent")),"function"==typeof s.onclick&&s.onclick(n),t.activeNode=n,t.activeNode.el.addClass("active"),t.activeNode.parent&&t.activeNode.parent.el.addClass("activeparent"),t.root.animateToStatic(),!1})}).prototype.animateToStatic=function(){clearTimeout(this.moveTimer);var t=this;this.moveTimer=setTimeout(function(){t.obj.movementStopped=!0},4e3),this.moving||(this.moving=!0,this.obj.movementStopped=!1,this.animateLoop())},a.prototype.animateLoop=function(){var t,e,i=this;for(this.obj.canvas.clear(),t=0,e=this.obj.lines.length;t<e;t++)this.obj.lines[t].updatePosition();this.findEquilibrium()||this.obj.movementStopped?this.moving=!1:setTimeout(function(){i.animateLoop()},10)},a.prototype.findEquilibrium=function(){var t,e,i=!0;for(i=this.display()&&i,t=0,e=this.children.length;t<e;t++)i=this.children[t].findEquilibrium()&&i;return i},a.prototype.display=function(e){var i,s,n=this;return e=e||0,this.visible?this.obj.activeNode!==this&&this.obj.activeNode!==this.parent&&this.obj.activeNode.parent!==this&&(this.el.hide(),this.visible=!1):this.obj.activeNode!==this&&this.obj.activeNode!==this.parent&&this.obj.activeNode.parent!==this||(this.el.show(),this.visible=!0),this.drawn=!0,this.hasPosition||(this.x=this.options.mapArea.x/2,this.y=this.options.mapArea.y/2,this.el.css({left:this.x+"px",top:this.y+"px"}),this.hasPosition=!0),i=2*Math.PI/this.children.length,o.each(this.children,function(t){this.hasPosition||(!this.options.showProgressive||e<=1)&&(s=t*i,this.x=50*Math.cos(s)+n.x,this.y=50*Math.sin(s)+n.y,this.hasPosition=!0,this.el.css({left:this.x+"px",top:this.y+"px"}))}),this.updatePosition()},a.prototype.updatePosition=function(){var t,e,i;return this.el.hasClass("ui-draggable-dragging")?(this.x=parseInt(this.el.css("left"),10)+this.el.width()/2,this.y=parseInt(this.el.css("top"),10)+this.el.height()/2,this.dx=0,this.dy=0,!1):(t=this.getForceVector(),this.dx+=t.x*this.options.timeperiod,this.dy+=t.y*this.options.timeperiod,this.dx=this.dx*this.options.damping,this.dy=this.dy*this.options.damping,Math.abs(this.dx)<this.options.minSpeed&&(this.dx=0),Math.abs(this.dy)<this.options.minSpeed&&(this.dy=0),Math.abs(this.dx)+Math.abs(this.dy)===0||(this.x+=this.dx*this.options.timeperiod,this.y+=this.dy*this.options.timeperiod,this.x=Math.min(this.options.mapArea.x,Math.max(1,this.x)),this.y=Math.min(this.options.mapArea.y,Math.max(1,this.y)),e=this.x-this.el.width()/2,i=this.y-this.el.height()/2-10,this.el.css({left:e+"px",top:i+"px"}),!1))},a.prototype.getForceVector=function(){var t,e,i,s,n,o,a,r,h,c,l,d=0,u=0,p=this.obj.nodes,m=this.obj.lines;for(t=0;t<p.length;t++)p[t]!==this&&p[t].visible&&(e=p[t].x-this.x,i=p[t].y-this.y,n=Math.sqrt(e*e+i*i),Math.abs(n)<500&&(0===e?(o=Math.PI/2,s=0):(o=Math.atan(i/e),s=e/Math.abs(e)),d+=-(a=500*this.options.repulse/(n*n))*Math.cos(o)*s,u+=-a*Math.sin(o)*s));for(r=this.x+this.el.width(),a=500*this.options.wallrepulse/(r*r),d+=Math.min(2,a),h=this.options.mapArea.x-r,a=-500*this.options.wallrepulse/(h*h),d+=Math.max(-2,a),a=500*this.options.wallrepulse/(this.y*this.y),u+=Math.min(2,a),c=this.options.mapArea.y-this.y,a=-500*this.options.wallrepulse/(c*c),u+=Math.max(-2,a),t=0;t<m.length;t++){if(l=null,m[t].start===this)l=m[t].end;else{if(m[t].end!==this)continue;l=m[t].start}l.visible&&(e=l.x-this.x,i=l.y-this.y,n=Math.sqrt(e*e+i*i),0<Math.abs(n)&&(0===e?(o=Math.PI/2,s=0):(o=Math.atan(i/e),s=e/Math.abs(e)),d+=(a=this.options.attract*n/1e4)*Math.cos(o)*s,u+=a*Math.sin(o)*s))}return this.obj.activeNode===this&&(e=(l=this.options.mapArea).x/2-this.options.centreOffset-this.x,i=l.y/2-this.y,n=Math.sqrt(e*e+i*i),0<Math.abs(n)&&(0===e?(o=Math.PI/2,s=0):(s=e/Math.abs(e),o=Math.atan(i/e)),d+=(a=.1*this.options.attract*n*3/1e3)*Math.cos(o)*s,u+=a*Math.sin(o)*s)),Math.abs(d)>this.options.maxForce&&(d=this.options.maxForce*(d/Math.abs(d))),Math.abs(u)>this.options.maxForce&&(u=this.options.maxForce*(u/Math.abs(u))),{x:d,y:u}},a.prototype.removeNode=function(){var t,e=this.obj.nodes,i=this.obj.lines;for(t=0;t<this.children.length;t++)this.children[t].removeNode();for(this.obj.nodes=[],t=0;t<e.length;t++)e[t]!==this&&this.obj.nodes.push(e[t]);for(this.obj.lines=[],t=0;t<i.length;t++)i[t].start!==this&&i[t].end!==this&&this.obj.lines.push(i[t]);this.el.remove()},(r=function(t,e,i){this.obj=t,this.options=t.options,this.start=e,this.colour="blue",this.size="thick",this.end=i}).prototype.updatePosition=function(){(this.options.showSublines||this.start.visible&&this.end.visible)&&(this.size=this.start.visible&&this.end.visible?"thick":"thin",this.color=this.obj.activeNode.parent===this.start||this.obj.activeNode.parent===this.end?"red":"blue",this.strokeStyle="#FFF",this.obj.canvas.path("M"+this.start.x+" "+this.start.y+"L"+this.end.x+" "+this.end.y).attr({stroke:this.strokeStyle,opacity:.2,"stroke-width":"5px"}))},o.fn.addNode=function(t,e,i){var s=this[0],n=s.nodes[s.nodes.length]=new a(s,e,t,i);return console.log(s.root),s.root.animateToStatic(),n},o.fn.addRootNode=function(t,e){var i=this[0].nodes[0]=new a(this[0],t,null,e);return this[0].root=i},o.fn.removeNode=function(t){return this.each(function(){})},o.fn.mindmap=function(t){t=o.extend({attract:15,repulse:6,damping:.55,timeperiod:10,wallrepulse:.4,mapArea:{x:-1,y:-1},canvasError:"alert",minSpeed:.05,maxForce:.1,showSublines:!1,updateIterationCount:20,showProgressive:!0,centreOffset:100,timer:0},t);var e=o(window);return this.each(function(){var n=this;this.mindmapInit=!0,this.nodes=[],this.lines=[],this.activeNode=null,this.options=t,this.animateToStatic=function(){this.root.animateToStatic()},e.resize(function(){n.animateToStatic()}),-1===t.mapArea.x&&(t.mapArea.x=e.width()),-1===t.mapArea.y&&(t.mapArea.y=e.height()),this.canvas=Raphael(0,0,t.mapArea.x,t.mapArea.y),o(this).addClass("js-mindmap-active"),o(this).keyup(function(t){var e,i,s=n.activeNode.parent;switch(t.which){case 33:case 38:s&&s.el.click();break;case 13:case 34:case 40:n.activeNode.children.length&&n.activeNode.children[0].el.click();break;case 37:if(s){if(e=null,s.children[0]===n.activeNode)e=s.children[s.children.length-1];else for(i=1;i<s.children.length;i++)s.children[i]===n.activeNode&&(e=s.children[i-1]);e&&e.el.click()}break;case 39:if(s){if(e=null,s.children[s.children.length-1]===n.activeNode)e=s.children[0];else for(i=s.children.length-2;0<=i;i--)s.children[i]===n.activeNode&&(e=s.children[i+1]);e&&e.el.click()}}return!1})})}}(jQuery);var camera,scene,renderer,stars=[];function init(){(camera=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,1e3)).position.z=5,scene=new THREE.Scene,(renderer=new THREE.WebGLRenderer).setSize(window.innerWidth,window.innerHeight),jQuery("#stars").append(renderer.domElement)}function addSphere(){for(var t=-1e3;t<1e3;t+=20){var e=new THREE.SphereGeometry(.5,32,32),i=new THREE.MeshBasicMaterial({color:16777215}),s=new THREE.Mesh(e,i);s.position.x=1e3*Math.random()-500,s.position.y=1e3*Math.random()-500,s.position.z=t,s.scale.x=s.scale.y=2,scene.add(s),stars.push(s)}}function animateStars(){for(var t=0;t<stars.length;t++)star=stars[t],star.position.z+=t/10,1e3<star.position.z&&(star.position.z-=2e3)}function render(){requestAnimationFrame(render),renderer.render(scene,camera),animateStars()}init(),addSphere(),render(),jQuery(window).on("resize",function(){renderer.setSize(window.innerWidth,window.innerHeight)});var menu_raphael={};function makeWheelNav(t,e){var s=[],n=[],o=new wheelnav(t);for(console.log(t,e),o.spreaderEnable=!1,o.cssMode=!0,o.maxPercent=1,o.clickModeRotate=!1,o.slicePathFunction=slicePath().DonutSlice,o.slicePathCustom=slicePath().PieSliceCustomization(),o.slicePathCustom.minRadiusPercent=.8,o.slicePathCustom.maxRadiusPercent=.9,o.sliceSelectedPathCustom=slicePath().PieSliceCustomization(),o.sliceSelectedPathCustom.minRadiusPercent=.8,o.sliceSelectedPathCustom.maxRadiusPercent=.99,o.titleSelectedAttr={},i=0;i<e.length;i++)s.push(e[i].title),n.push(e[i].id);o.initWheel(s);var a=360/o.navItemCount,r=90;for(i=0;i<o.navItemCount;i++)o.navItems[i].titleRotateAngle=r,r=a+(90-a);for(o.createWheel(),counter=0,i=0;i<o.navItemCount;i++)o.navItems[i].data=e[i],"inner-nav"!=t&&(o.navItems[i].navigateFunction=function(){makeWheelNav("inner-nav",this.data.children)});menu_raphael[t]=o.raphael}window.onload=function(){};