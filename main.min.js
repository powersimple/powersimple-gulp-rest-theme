function reposition_screen(){var t=jQuery(window).width();jQuery(window).height()<t?(jQuery("#screen").css("width","61.8vh"),jQuery("#screen").css("height","61.8vh"),jQuery("#screen").css("margin-left","-30.9vh"),jQuery("#screen").css("margin-top","-30.9vh")):(jQuery("#screen").css("width","61.8vw"),jQuery("#screen").css("height","61.8vw"),jQuery("#screen").css("margin-left","-30.9vw"),jQuery("#screen").css("margin-top","-30.9vw")),jQuery("body").css("max-width","100vw"),jQuery("body").css("max-height","100vh"),jQuery("body").css("max-width","100vw"),jQuery("body").css("max-height","100vh"),jQuery("#stars").css("height","100vh"),jQuery("#stars").css("width","100vw")}jQuery(window).resize(function(){reposition_screen()}),reposition_screen();var posts={},categories={},tags={};function getREST(t,e,s,o){var i="/wp-json/wp/v2/"+t;jQuery.ajax({url:i,data:e,success:function(t,e,i){return s(t,o)},error:function(t,e,i){console.log(t.responseText)},cache:!1})}function setPosts(t,e){for(var i="post",s=0;s<t.length;s++)void 0!==t[s].title&&void 0!==t[s].title.rendered&&(t[s].title=t[s].title.rendered),void 0!==t[s].content&&void 0!==t[s].content.rendered&&(t[s].content=t[s].content.rendered),void 0!==t[s].type&&(i=t[s].type,posts[t[s].id]=t[s]);if(void 0!==i)switch(i){case i="project":}return posts}function setChildCategories(t,e){for(var i=0;i<t.length;i++)categories[t[i].id]=t[i];return displayCategories(e,categories),t}function setTags(t,e){for(var i=0;i<t.length;i++)tags[t[i].id]=t[i];return displayTags(e,tags),t}function navTab(t){var e="";return e+="<li data-id="+t.id+" class='nav__item'>",e+="<span>",e+=t.name,e+="</span>",e+="</li>"}function displayProjects(t){var e="";if(0<t.length){for(e="<ul class='nav_project'>",i=0;i<t.length;i++)displayProjectCard(t[i]);e+="</ul>"}jQuery("#project-nav").html(e)}function displayProjectCard(t){var e=posts[t];console.log(e);var i='<li class="project-card">';return i+=e.title,i+="</li>"}function displayTags(t,e){for(var i in e)console.log("tag",e[i].id)}function displayCategories(t,e){var i="<ul class='nav_cat'>";for(var s in e)i+=navTab(e[s]),console.log(t,"cat",e[s].id);i+="</ul>",jQuery(t).html(i)}getREST("posts","fields=id,type,title,content,slug,excerpt,thumbnail_url,project_info,thumbnail_versions,featured_video,type",setPosts),getREST("pages","fields=id,type,title,content,slug,excerpt,thumbnail_url,project_info,thumbnail_versions,featured_video,type",setPosts),getREST("project","fields=id,type,title,content,slug,excerpt,thumbnail_url,project_info,thumbnail_versions,featured_videotype",setPosts),getREST("categories","parent=19&fields=id,name,count,slug,description,category_posts",setChildCategories,"#category-menu"),getREST("tags","fields=id,name,slug,tag_posts",setTags),function(n){"use strict";var a,r;(a=function(t,e,i,s){this.obj=t,this.options=t.options,this.name=e,this.href=s.href,s.url&&(this.url=s.url),this.el=n('<a href="'+this.href+'">'+this.name+"</a>").addClass("node"),n("body").prepend(this.el),i?t.lines[t.lines.length]=new r(t,this,i):(t.activeNode=this).el.addClass("active root"),this.parent=i,this.children=[],this.parent&&this.parent.children.push(this),this.moving=!1,this.moveTimer=0,this.obj.movementStopped=!1,this.visible=!0,this.x=1,this.y=1,this.dx=0,this.dy=0,this.hasPosition=!1,this.content=[],this.el.css("position","absolute");var o=this;this.el.draggable({drag:function(){t.root.animateToStatic()}}),this.el.click(function(){return t.activeNode&&(t.activeNode.el.removeClass("active"),t.activeNode.parent&&t.activeNode.parent.el.removeClass("activeparent")),"function"==typeof s.onclick&&s.onclick(o),t.activeNode=o,t.activeNode.el.addClass("active"),t.activeNode.parent&&t.activeNode.parent.el.addClass("activeparent"),t.root.animateToStatic(),!1})}).prototype.animateToStatic=function(){clearTimeout(this.moveTimer);var t=this;this.moveTimer=setTimeout(function(){t.obj.movementStopped=!0},4e3),this.moving||(this.moving=!0,this.obj.movementStopped=!1,this.animateLoop())},a.prototype.animateLoop=function(){var t,e,i=this;for(this.obj.canvas.clear(),t=0,e=this.obj.lines.length;t<e;t++)this.obj.lines[t].updatePosition();this.findEquilibrium()||this.obj.movementStopped?this.moving=!1:setTimeout(function(){i.animateLoop()},10)},a.prototype.findEquilibrium=function(){var t,e,i=!0;for(i=this.display()&&i,t=0,e=this.children.length;t<e;t++)i=this.children[t].findEquilibrium()&&i;return i},a.prototype.display=function(e){var i,s,o=this;return e=e||0,this.visible?this.obj.activeNode!==this&&this.obj.activeNode!==this.parent&&this.obj.activeNode.parent!==this&&(this.el.hide(),this.visible=!1):this.obj.activeNode!==this&&this.obj.activeNode!==this.parent&&this.obj.activeNode.parent!==this||(this.el.show(),this.visible=!0),this.drawn=!0,this.hasPosition||(this.x=this.options.mapArea.x/2,this.y=this.options.mapArea.y/2,this.el.css({left:this.x+"px",top:this.y+"px"}),this.hasPosition=!0),i=2*Math.PI/this.children.length,n.each(this.children,function(t){this.hasPosition||(!this.options.showProgressive||e<=1)&&(s=t*i,this.x=50*Math.cos(s)+o.x,this.y=50*Math.sin(s)+o.y,this.hasPosition=!0,this.el.css({left:this.x+"px",top:this.y+"px"}))}),this.updatePosition()},a.prototype.updatePosition=function(){var t,e,i;return this.el.hasClass("ui-draggable-dragging")?(this.x=parseInt(this.el.css("left"),10)+this.el.width()/2,this.y=parseInt(this.el.css("top"),10)+this.el.height()/2,this.dx=0,this.dy=0,!1):(t=this.getForceVector(),this.dx+=t.x*this.options.timeperiod,this.dy+=t.y*this.options.timeperiod,this.dx=this.dx*this.options.damping,this.dy=this.dy*this.options.damping,Math.abs(this.dx)<this.options.minSpeed&&(this.dx=0),Math.abs(this.dy)<this.options.minSpeed&&(this.dy=0),Math.abs(this.dx)+Math.abs(this.dy)===0||(this.x+=this.dx*this.options.timeperiod,this.y+=this.dy*this.options.timeperiod,this.x=Math.min(this.options.mapArea.x,Math.max(1,this.x)),this.y=Math.min(this.options.mapArea.y,Math.max(1,this.y)),e=this.x-this.el.width()/2,i=this.y-this.el.height()/2-10,this.el.css({left:e+"px",top:i+"px"}),!1))},a.prototype.getForceVector=function(){var t,e,i,s,o,n,a,r,h,c,d,l=0,p=0,u=this.obj.nodes,v=this.obj.lines;for(t=0;t<u.length;t++)u[t]!==this&&u[t].visible&&(e=u[t].x-this.x,i=u[t].y-this.y,o=Math.sqrt(e*e+i*i),Math.abs(o)<500&&(0===e?(n=Math.PI/2,s=0):(n=Math.atan(i/e),s=e/Math.abs(e)),l+=-(a=500*this.options.repulse/(o*o))*Math.cos(n)*s,p+=-a*Math.sin(n)*s));for(r=this.x+this.el.width(),a=500*this.options.wallrepulse/(r*r),l+=Math.min(2,a),h=this.options.mapArea.x-r,a=-500*this.options.wallrepulse/(h*h),l+=Math.max(-2,a),a=500*this.options.wallrepulse/(this.y*this.y),p+=Math.min(2,a),c=this.options.mapArea.y-this.y,a=-500*this.options.wallrepulse/(c*c),p+=Math.max(-2,a),t=0;t<v.length;t++){if(d=null,v[t].start===this)d=v[t].end;else{if(v[t].end!==this)continue;d=v[t].start}d.visible&&(e=d.x-this.x,i=d.y-this.y,o=Math.sqrt(e*e+i*i),0<Math.abs(o)&&(0===e?(n=Math.PI/2,s=0):(n=Math.atan(i/e),s=e/Math.abs(e)),l+=(a=this.options.attract*o/1e4)*Math.cos(n)*s,p+=a*Math.sin(n)*s))}return this.obj.activeNode===this&&(e=(d=this.options.mapArea).x/2-this.options.centreOffset-this.x,i=d.y/2-this.y,o=Math.sqrt(e*e+i*i),0<Math.abs(o)&&(0===e?(n=Math.PI/2,s=0):(s=e/Math.abs(e),n=Math.atan(i/e)),l+=(a=.1*this.options.attract*o*3/1e3)*Math.cos(n)*s,p+=a*Math.sin(n)*s)),Math.abs(l)>this.options.maxForce&&(l=this.options.maxForce*(l/Math.abs(l))),Math.abs(p)>this.options.maxForce&&(p=this.options.maxForce*(p/Math.abs(p))),{x:l,y:p}},a.prototype.removeNode=function(){var t,e=this.obj.nodes,i=this.obj.lines;for(t=0;t<this.children.length;t++)this.children[t].removeNode();for(this.obj.nodes=[],t=0;t<e.length;t++)e[t]!==this&&this.obj.nodes.push(e[t]);for(this.obj.lines=[],t=0;t<i.length;t++)i[t].start!==this&&i[t].end!==this&&this.obj.lines.push(i[t]);this.el.remove()},(r=function(t,e,i){this.obj=t,this.options=t.options,this.start=e,this.colour="blue",this.size="thick",this.end=i}).prototype.updatePosition=function(){(this.options.showSublines||this.start.visible&&this.end.visible)&&(this.size=this.start.visible&&this.end.visible?"thick":"thin",this.color=this.obj.activeNode.parent===this.start||this.obj.activeNode.parent===this.end?"red":"blue",this.strokeStyle="#FFF",this.obj.canvas.path("M"+this.start.x+" "+this.start.y+"L"+this.end.x+" "+this.end.y).attr({stroke:this.strokeStyle,opacity:.2,"stroke-width":"5px"}))},n.fn.addNode=function(t,e,i){var s=this[0],o=s.nodes[s.nodes.length]=new a(s,e,t,i);return console.log(s.root),s.root.animateToStatic(),o},n.fn.addRootNode=function(t,e){var i=this[0].nodes[0]=new a(this[0],t,null,e);return this[0].root=i},n.fn.removeNode=function(t){return this.each(function(){})},n.fn.mindmap=function(t){t=n.extend({attract:15,repulse:6,damping:.55,timeperiod:10,wallrepulse:.4,mapArea:{x:-1,y:-1},canvasError:"alert",minSpeed:.05,maxForce:.1,showSublines:!1,updateIterationCount:20,showProgressive:!0,centreOffset:100,timer:0},t);var e=n(window);return this.each(function(){var o=this;this.mindmapInit=!0,this.nodes=[],this.lines=[],this.activeNode=null,this.options=t,this.animateToStatic=function(){this.root.animateToStatic()},e.resize(function(){o.animateToStatic()}),-1===t.mapArea.x&&(t.mapArea.x=e.width()),-1===t.mapArea.y&&(t.mapArea.y=e.height()),this.canvas=Raphael(0,0,t.mapArea.x,t.mapArea.y),n(this).addClass("js-mindmap-active"),n(this).keyup(function(t){var e,i,s=o.activeNode.parent;switch(t.which){case 33:case 38:s&&s.el.click();break;case 13:case 34:case 40:o.activeNode.children.length&&o.activeNode.children[0].el.click();break;case 37:if(s){if(e=null,s.children[0]===o.activeNode)e=s.children[s.children.length-1];else for(i=1;i<s.children.length;i++)s.children[i]===o.activeNode&&(e=s.children[i-1]);e&&e.el.click()}break;case 39:if(s){if(e=null,s.children[s.children.length-1]===o.activeNode)e=s.children[0];else for(i=s.children.length-2;0<=i;i--)s.children[i]===o.activeNode&&(e=s.children[i+1]);e&&e.el.click()}}return!1})})}}(jQuery),jQuery("#portfolio").on("click",".nav__item",function(){var t=jQuery(this).data("id");displayProjects(categories[t].category_posts)});var camera,scene,renderer,stars=[];function init(){(camera=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,1e3)).position.z=5,scene=new THREE.Scene,(renderer=new THREE.WebGLRenderer).setSize(window.innerWidth,window.innerHeight),jQuery("#stars").append(renderer.domElement)}function addSphere(){for(var t=-1e3;t<1e3;t+=20){var e=new THREE.SphereGeometry(.5,32,32),i=new THREE.MeshBasicMaterial({color:16777215}),s=new THREE.Mesh(e,i);s.position.x=1e3*Math.random()-500,s.position.y=1e3*Math.random()-500,s.position.z=t,s.scale.x=s.scale.y=2,scene.add(s),stars.push(s)}}function animateStars(){for(var t=0;t<stars.length;t++)star=stars[t],star.position.z+=t/10,1e3<star.position.z&&(star.position.z-=2e3)}function render(){requestAnimationFrame(render),renderer.render(scene,camera),animateStars()}init(),addSphere(),render(),jQuery(window).on("resize",function(){renderer.setSize(window.innerWidth,window.innerHeight)});