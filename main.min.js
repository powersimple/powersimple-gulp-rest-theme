var posts={},categories={},tags={};function getREST(t,i,s,o){var e="/wp-json/wp/v2/"+t;jQuery.ajax({url:e,data:i,success:function(t,i,e){return s(t,o)},error:function(t,i,e){console.log(t.responseText)},cache:!1})}function setPosts(t,i){for(var e="post",s=0;s<t.length;s++)void 0!==t[s].title&&void 0!==t[s].title.rendered&&(t[s].title=t[s].title.rendered),void 0!==t[s].content&&void 0!==t[s].content.rendered&&(t[s].content=t[s].content.rendered),void 0!==t[s].type&&(e=t[s].type,posts[t[s].id]=t[s]);if(void 0!==e)switch(e){case e="project":}return posts}function setChildCategories(t,i){for(var e=0;e<t.length;e++)categories[t[e].id]=t[e];return displayCategories(i,categories),t}function setTags(t,i){for(var e=0;e<t.length;e++)tags[t[e].id]=t[e];return displayTags(i,tags),t}function navTab(t){var i="";return i+="<li data-id="+t.id+" class='nav__item'>",i+="<span>",i+=t.name,i+="</span>",i+="</li>"}function displayProjects(t){if(0<t.length){var e="<ul class='nav_project'>";for(i=0;i<t.length;i++)displayProjectCard(t[i]);e+="</ul>"}jQuery("#project-nav").html(e)}function displayProjectCard(t){var i=posts[t];console.log(i);var e='<li class="project-card">';return e+=i.title,e+="</li>"}function displayTags(t,i){for(var e in i)console.log("tag",i[e].id)}function displayCategories(t,i){var e="<ul class='nav_cat'>";for(var s in i)e+=navTab(i[s]),console.log(t,"cat",i[s].id);e+="</ul>",jQuery(t).html(e)}getREST("posts","fields=id,type,title,content,slug,excerpt,thumbnail_url,project_info,thumbnail_versions,featured_video,type",setPosts),getREST("pages","fields=id,type,title,content,slug,excerpt,thumbnail_url,project_info,thumbnail_versions,featured_video,type",setPosts),getREST("project","fields=id,type,title,content,slug,excerpt,thumbnail_url,project_info,thumbnail_versions,featured_videotype",setPosts),getREST("categories","parent=19&fields=id,name,count,slug,description,category_posts",setChildCategories,"#category-menu"),getREST("tags","fields=id,name,slug,tag_posts",setTags),function(n){"use strict";var a,h;(a=function(t,i,e,s){this.obj=t,this.options=t.options,this.name=i,this.href=s.href,s.url&&(this.url=s.url),this.el=n('<a href="'+this.href+'">'+this.name+"</a>").addClass("node"),n("body").prepend(this.el),e?t.lines[t.lines.length]=new h(t,this,e):(t.activeNode=this).el.addClass("active root"),this.parent=e,this.children=[],this.parent&&this.parent.children.push(this),this.moving=!1,this.moveTimer=0,this.obj.movementStopped=!1,this.visible=!0,this.x=1,this.y=1,this.dx=0,this.dy=0,this.hasPosition=!1,this.content=[],this.el.css("position","absolute");var o=this;this.el.draggable({drag:function(){t.root.animateToStatic()}}),this.el.click(function(){return t.activeNode&&(t.activeNode.el.removeClass("active"),t.activeNode.parent&&t.activeNode.parent.el.removeClass("activeparent")),"function"==typeof s.onclick&&s.onclick(o),t.activeNode=o,t.activeNode.el.addClass("active"),t.activeNode.parent&&t.activeNode.parent.el.addClass("activeparent"),t.root.animateToStatic(),!1})}).prototype.animateToStatic=function(){clearTimeout(this.moveTimer);var t=this;this.moveTimer=setTimeout(function(){t.obj.movementStopped=!0},4e3),this.moving||(this.moving=!0,this.obj.movementStopped=!1,this.animateLoop())},a.prototype.animateLoop=function(){var t,i,e=this;for(this.obj.canvas.clear(),t=0,i=this.obj.lines.length;t<i;t++)this.obj.lines[t].updatePosition();this.findEquilibrium()||this.obj.movementStopped?this.moving=!1:setTimeout(function(){e.animateLoop()},10)},a.prototype.findEquilibrium=function(){var t,i,e=!0;for(e=this.display()&&e,t=0,i=this.children.length;t<i;t++)e=this.children[t].findEquilibrium()&&e;return e},a.prototype.display=function(i){var e,s,o=this;return i=i||0,this.visible?this.obj.activeNode!==this&&this.obj.activeNode!==this.parent&&this.obj.activeNode.parent!==this&&(this.el.hide(),this.visible=!1):this.obj.activeNode!==this&&this.obj.activeNode!==this.parent&&this.obj.activeNode.parent!==this||(this.el.show(),this.visible=!0),this.drawn=!0,this.hasPosition||(this.x=this.options.mapArea.x/2,this.y=this.options.mapArea.y/2,this.el.css({left:this.x+"px",top:this.y+"px"}),this.hasPosition=!0),e=2*Math.PI/this.children.length,n.each(this.children,function(t){this.hasPosition||(!this.options.showProgressive||i<=1)&&(s=t*e,this.x=50*Math.cos(s)+o.x,this.y=50*Math.sin(s)+o.y,this.hasPosition=!0,this.el.css({left:this.x+"px",top:this.y+"px"}))}),this.updatePosition()},a.prototype.updatePosition=function(){var t,i,e;return this.el.hasClass("ui-draggable-dragging")?(this.x=parseInt(this.el.css("left"),10)+this.el.width()/2,this.y=parseInt(this.el.css("top"),10)+this.el.height()/2,this.dx=0,this.dy=0,!1):(t=this.getForceVector(),this.dx+=t.x*this.options.timeperiod,this.dy+=t.y*this.options.timeperiod,this.dx=this.dx*this.options.damping,this.dy=this.dy*this.options.damping,Math.abs(this.dx)<this.options.minSpeed&&(this.dx=0),Math.abs(this.dy)<this.options.minSpeed&&(this.dy=0),Math.abs(this.dx)+Math.abs(this.dy)===0||(this.x+=this.dx*this.options.timeperiod,this.y+=this.dy*this.options.timeperiod,this.x=Math.min(this.options.mapArea.x,Math.max(1,this.x)),this.y=Math.min(this.options.mapArea.y,Math.max(1,this.y)),i=this.x-this.el.width()/2,e=this.y-this.el.height()/2-10,this.el.css({left:i+"px",top:e+"px"}),!1))},a.prototype.getForceVector=function(){var t,i,e,s,o,n,a,h,r,c,l,d=0,p=0,u=this.obj.nodes,v=this.obj.lines;for(t=0;t<u.length;t++)u[t]!==this&&u[t].visible&&(i=u[t].x-this.x,e=u[t].y-this.y,o=Math.sqrt(i*i+e*e),Math.abs(o)<500&&(0===i?(n=Math.PI/2,s=0):(n=Math.atan(e/i),s=i/Math.abs(i)),d+=-(a=500*this.options.repulse/(o*o))*Math.cos(n)*s,p+=-a*Math.sin(n)*s));for(h=this.x+this.el.width(),a=500*this.options.wallrepulse/(h*h),d+=Math.min(2,a),r=this.options.mapArea.x-h,a=-500*this.options.wallrepulse/(r*r),d+=Math.max(-2,a),a=500*this.options.wallrepulse/(this.y*this.y),p+=Math.min(2,a),c=this.options.mapArea.y-this.y,a=-500*this.options.wallrepulse/(c*c),p+=Math.max(-2,a),t=0;t<v.length;t++){if(l=null,v[t].start===this)l=v[t].end;else{if(v[t].end!==this)continue;l=v[t].start}l.visible&&(i=l.x-this.x,e=l.y-this.y,o=Math.sqrt(i*i+e*e),0<Math.abs(o)&&(0===i?(n=Math.PI/2,s=0):(n=Math.atan(e/i),s=i/Math.abs(i)),d+=(a=this.options.attract*o/1e4)*Math.cos(n)*s,p+=a*Math.sin(n)*s))}return this.obj.activeNode===this&&(i=(l=this.options.mapArea).x/2-this.options.centreOffset-this.x,e=l.y/2-this.y,o=Math.sqrt(i*i+e*e),0<Math.abs(o)&&(0===i?(n=Math.PI/2,s=0):(s=i/Math.abs(i),n=Math.atan(e/i)),d+=(a=.1*this.options.attract*o*3/1e3)*Math.cos(n)*s,p+=a*Math.sin(n)*s)),Math.abs(d)>this.options.maxForce&&(d=this.options.maxForce*(d/Math.abs(d))),Math.abs(p)>this.options.maxForce&&(p=this.options.maxForce*(p/Math.abs(p))),{x:d,y:p}},a.prototype.removeNode=function(){var t,i=this.obj.nodes,e=this.obj.lines;for(t=0;t<this.children.length;t++)this.children[t].removeNode();for(this.obj.nodes=[],t=0;t<i.length;t++)i[t]!==this&&this.obj.nodes.push(i[t]);for(this.obj.lines=[],t=0;t<e.length;t++)e[t].start!==this&&e[t].end!==this&&this.obj.lines.push(e[t]);this.el.remove()},(h=function(t,i,e){this.obj=t,this.options=t.options,this.start=i,this.colour="blue",this.size="thick",this.end=e}).prototype.updatePosition=function(){(this.options.showSublines||this.start.visible&&this.end.visible)&&(this.size=this.start.visible&&this.end.visible?"thick":"thin",this.color=this.obj.activeNode.parent===this.start||this.obj.activeNode.parent===this.end?"red":"blue",this.strokeStyle="#FFF",this.obj.canvas.path("M"+this.start.x+" "+this.start.y+"L"+this.end.x+" "+this.end.y).attr({stroke:this.strokeStyle,opacity:.2,"stroke-width":"5px"}))},n.fn.addNode=function(t,i,e){var s=this[0],o=s.nodes[s.nodes.length]=new a(s,i,t,e);return console.log(s.root),s.root.animateToStatic(),o},n.fn.addRootNode=function(t,i){var e=this[0].nodes[0]=new a(this[0],t,null,i);return this[0].root=e},n.fn.removeNode=function(t){return this.each(function(){})},n.fn.mindmap=function(t){t=n.extend({attract:15,repulse:6,damping:.55,timeperiod:10,wallrepulse:.4,mapArea:{x:-1,y:-1},canvasError:"alert",minSpeed:.05,maxForce:.1,showSublines:!1,updateIterationCount:20,showProgressive:!0,centreOffset:100,timer:0},t);var i=n(window);return this.each(function(){var o=this;this.mindmapInit=!0,this.nodes=[],this.lines=[],this.activeNode=null,this.options=t,this.animateToStatic=function(){this.root.animateToStatic()},i.resize(function(){o.animateToStatic()}),-1===t.mapArea.x&&(t.mapArea.x=i.width()),-1===t.mapArea.y&&(t.mapArea.y=i.height()),this.canvas=Raphael(0,0,t.mapArea.x,t.mapArea.y),n(this).addClass("js-mindmap-active"),n(this).keyup(function(t){var i,e,s=o.activeNode.parent;switch(t.which){case 33:case 38:s&&s.el.click();break;case 13:case 34:case 40:o.activeNode.children.length&&o.activeNode.children[0].el.click();break;case 37:if(s){if(i=null,s.children[0]===o.activeNode)i=s.children[s.children.length-1];else for(e=1;e<s.children.length;e++)s.children[e]===o.activeNode&&(i=s.children[e-1]);i&&i.el.click()}break;case 39:if(s){if(i=null,s.children[s.children.length-1]===o.activeNode)i=s.children[0];else for(e=s.children.length-2;0<=e;e--)s.children[e]===o.activeNode&&(i=s.children[e+1]);i&&i.el.click()}}return!1})})}}(jQuery),jQuery("#portfolio").on("click",".nav__item",function(){var t=jQuery(this).data("id");displayProjects(categories[t].category_posts)});var camera,scene,renderer,stars=[];function init(){(camera=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,1e3)).position.z=5,scene=new THREE.Scene,(renderer=new THREE.WebGLRenderer).setSize(window.innerWidth,window.innerHeight),jQuery("#stars").append(renderer.domElement)}function addSphere(){for(var t=-1e3;t<1e3;t+=20){var i=new THREE.SphereGeometry(.5,32,32),e=new THREE.MeshBasicMaterial({color:16777215}),s=new THREE.Mesh(i,e);s.position.x=1e3*Math.random()-500,s.position.y=1e3*Math.random()-500,s.position.z=t,s.scale.x=s.scale.y=2,scene.add(s),stars.push(s)}}function animateStars(){for(var t=0;t<stars.length;t++)star=stars[t],star.position.z+=t/10,1e3<star.position.z&&(star.position.z-=2e3)}function render(){requestAnimationFrame(render),renderer.render(scene,camera),animateStars()}init(),addSphere(),render();