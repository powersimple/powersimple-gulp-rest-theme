var increment="vw",orientation="vertical",_w=jQuery(window).width(),_h=jQuery(window).height();function calibrateCircle(e,n,t){jQuery(e).css("width",n+t),jQuery(e).css("height",n+t),jQuery(e).css("margin-left",n/2*-1+t),jQuery(e).css("margin-top",n/2*-1+t)}function pinSlider(){_h<=_w?(orientation="vertical",slider_left=_w/2+.8*_h/2+_w/10+"px",jQuery("#slider.ui-slider-vertical").css("left",slider_left),jQuery("#slider.ui-slider-vertical").css("top","19.9%")):(orientation="horizontal",slider_top=_h/2+.8*_w/2+24+"px",jQuery("#slider.ui-slider-horizontal").css("top",slider_top),jQuery("#slider.ui-slider-horizontal").css("left","19.9%"))}function reposition_screen(){jQuery("#main").css("height","100vw"),jQuery("#main").css("width","100vh"),setSlider(),pinSlider(),jQuery("#slider").css("visibility","visible");for(var e=[{id:".phi-centered",size:61.8,increment:"vw"},{id:"#outer-ring",size:80,increment:"vw"},{id:"#inner-ring",size:72,increment:"vw"},{id:"#inner-subring",size:65,increment:"vw"}],n=0;n<e.length;n++){var t=e[n];_w<540&&(t.size+=14),_h<_w?("vw"==t.increment&&(t.increment="vh"),calibrateCircle(t.id,t.size,t.increment),jQuery(".slick-track").css("height","61.8vh")):(calibrateCircle(t.id,t.size,t.increment),jQuery(".slick-track").css("height","61.8vw"))}jQuery("#stars").css("height","100vh"),jQuery("#stars").css("width","100vw")}function setSlideContent(e,n){null!=posts[n]&&(jQuery("#slide"+e+" h2").html(posts[+n].title),jQuery("#slide"+e+" section div.content").html(posts[+n].content),$carousel.slick("slickGoTo",e))}function setContent(e,n,t){var i=posts_nav[n];null!=posts[n]&&(page_title=posts[n].title+" | "+site_title,document.title=page_title,jQuery("#featured-image").attr("src",posts[n].thumbnail_url["square-large"])),setSlideContent(i,n)}function displayPage(e,n){var t="";if(0<n.length){for(t="<ul class='nav_project'>",i=0;i<post_ids.length;i++)displayProjectCard(n[i]);t+="</ul>"}jQuery("#project-nav").html(t)}function displayPosts(e,n){if(0<n.length){for("<ul class='nav_project'>",i=0;i<post_ids.length;i++);"</ul>"}}function displayProjects(e,n){var t="";if(0<n.length){for(type=data[i].type,n["p"+data[i].id]=data[i],t="<ul class='nav_project'>",i=0;i<post_ids.length;i++)displayProjectCard(n[i]);t+="</ul>"}jQuery("#project-nav").html(t)}function displayProjectCard(e){var n='<li class="project-card">';return n+=posts[e].title,n+="</li>"}function menu_order(e,n){return e.menu_order<n.menu_order?-1:e.menu_order>n.menu_order?1:0}function post_order(e,n){return e<n?-1:n<e?1:0}function setLinearNav(e){var n=0;for(var t in e.items)e.items[t].post=posts[e.items[t].object_id],e.items[t].slug=posts[e.items[t].object_id].slug,id=e.items[t].object_id.toString(),linear_nav.push(e.items[t]),posts_nav[id]=n,n++;linear_nav.sort(menu_order);for(var i=0;i<linear_nav.length;i++);setSlider(linear_nav),setSlides(linear_nav)}function setLinearDataNav(e){for(var n=0,t=0,i=0,a=0,r="outer-nav",s=0;s<e.length;s++){r="outer-nav",e[s].dest=r,e[s].slice=t,i=e[s].notch=n,data_nav.push(e[s]),slug_nav[e[s].slug]=n,n++;for(var l=0;l<e[s].children.length;l++){e[s].children[l].dest="inner-nav",e[s].children[l].slice=l,e[s].children[l].notch=n,e[s].children[l].parent=i,a=n,data_nav.push(e[s].children[l]),slug_nav[e[s].children[l].slug]=n,n++;for(var o=0;o<e[s].children[l].children.length;o++)e[s].children[l].children[o].dest="inner-subnav",e[s].children[l].children[o].slice=o,e[s].children[l].children[o].notch=n,e[s].children[l].children[o].grandparent=i,e[s].children[l].children[o].parent=a,data_nav.push(e[s].children[l].children[o]),slug_nav[e[s].children[l].children[o].slug]=n,n++}t++}console.log("dataNav",data_nav)}function displayMenus(){var e=[];for(var n in menus)if(null!=menu_config[n]){for(var t in menu_array=[],menus[n].items)0==menus[n].items[t].parent&&menu_array.push(menus[n].items[t]);menu_array.sort(menu_order);for(var i=[],a=0;a<menu_array.length;a++){i=[];for(var r=0;r<menu_array[a].children.length;r++){for(var s=[],l=menus[n].items[menu_array[a].children[r]].children,o=0;o<l.length;o++)s.push({title:menus[n].items[l[o]].title,slug:posts[menus[n].items[l[o]].object_id].slug,object:menus[n].items[l[o]].object,object_id:menus[n].items[l[o]].object_id});i.push({title:menus[n].items[menu_array[a].children[r]].title,slug:posts[menus[n].items[menu_array[a].children[r]].object_id].slug,object:menus[n].items[menu_array[a].children[r]].object,object_id:menus[n].items[menu_array[a].children[r]].object_id,children:s})}e.push({title:menu_array[a].title,slug:posts[menu_array[a].object_id].slug,object:menu_array[a].object,object_id:menu_array[a].object_id,children:i})}if(setLinearDataNav(menu_levels=e),setLinearNav(menus[n]),jQuery(menu_config[n].location).html(""),setSlideShow(),makeWheelNav("outer-nav",menu_levels,menu_config[n]._p),""!=location.hash){var c=location.hash.replace("#","");console.log("set by slugHash",c,slug_nav[c]),setSliderNotch(slug_nav[c])}else menu_config[n].menu_type;console.log("makeouterwheel",menu_levels)}}function displayTags(e,n){for(var t in n);}function displayCategories(e,n){var t="<ul class='nav_cat'>";for(var i in n)t+=navTab(n[i]);t+="</ul>",jQuery(e).html(t)}jQuery(document).ready(function(){jQuery(".wheelnav-outer-nav-title").css("display:none;"),reposition_screen()}),jQuery(window).resize(function(){_w=jQuery(window).width(),_h=jQuery(window).height(),increment=_h<_w?"vh":"vw",reposition_screen()}),jQuery("#portfolio").on("click",".nav__item",function(){var e=jQuery(this).data("id");displayProjects(categories[e].category_posts)});var posts={},categories={},tags={},menus={},linear_nav=[],posts_nav={},posts_slug_ids={},slug_nav={},data_nav=[],last_dest="outer-nav",menu_levels=[];function getStaticJSON(e,i,a){var n=json_path+e+".json";console.log("endpoint",n),jQuery.ajax({url:n,data:"",success:function(e,n,t){return i(e,a)},error:function(e,n,t){},cache:!1})}function setPosts(e,n){var t="post";if(Array.isArray(e))for(var i=0;i<e.length;i++)void 0!==e[i].title&&void 0!==e[i].title.rendered&&(e[i].title=e[i].title.rendered),void 0!==e[i].content&&void 0!==e[i].content.rendered&&(e[i].content=e[i].content.rendered),void 0!==e[i].type&&(t=e[i].type,posts[e[i].id]=e[i]);else t=e.type,posts[e.id]=e;if(void 0!==t)switch(t){case t="project":case t="post":case t="page":}return posts}function setMenuItem(e,n){return this_item={},this_item.menu_id=n.ID,this_item.title=n.title,this_item.menu_order=n.menu_order,this_item.object=n.object,this_item.object_id=n.object_id,this_item.parent=n.menu_item_parent,this_item.dest=e,this_item.children=[],this_item}function setMenu(e,n,t){menu={};for(var i=0;i<t.length;i++)menu[t[i].ID]=setMenuItem(e,t[i]),0!=t[i].menu_item_parent&&menu[t[i].menu_item_parent].children.push(t[i].ID),menus[e].menu_array.push(menu[t[i].ID]);return menu}function setMenus(e,n){menus[n]={},menus[n].menu_array=[];for(var t=0;t<e.length;t++)menus[e[t].slug]={},menus[e[t].slug].name=e[t].name,menus[e[t].slug].items=setMenu(n,e[t].slug,e[t].items);displayMenus()}function setChildCategories(e,n){for(var t=0;t<e.length;t++)categories[e[t].id]=e[t];return e}function setCategories(e,n){for(var t=0;t<e.length;t++)categories[e[t].id]=e[t];return e}function setTags(e,n){for(var t=0;t<e.length;t++)tags[e[t].id]=e[t];return displayTags(n,tags),e}getStaticJSON("posts",setPosts,"#posts"),getStaticJSON("pages",setPosts,"#pages"),getStaticJSON("project",setPosts,"#projects"),getStaticJSON("categories",setCategories,"#category-menu"),getStaticJSON("tags",setTags,"tags"),getStaticJSON("menus",setMenus,"#main-menu");var columns,drops,drawnToBottom,canvas=document.getElementById("matrix"),ctx=canvas.getContext("2d"),fontSize=18,chars=generateChars();function generateChars(){for(var e="0123456789",n=0;n<=55;n++)e+=String.fromCharCode(n+65382);return e.split("")}function initCanvas(){canvas.width=window.innerWidth,canvas.height=window.innerHeight,columns=Math.round(canvas.width/fontSize),drops=[];for(var e=0;e<columns;e++)drops[e]=1;drawnToBottom=!1}function draw(){ctx.fillStyle="rgba(0, 0, 0, 0.05)",ctx.fillRect(0,0,canvas.width,canvas.height),ctx.fillStyle="#19FF19",ctx.font="bold "+fontSize+"px monospace";for(var e=drops.length,n=chars.length,t=0;t<e;t++){var i=chars[Math.floor(Math.random()*n)],a=drops[t]*fontSize;ctx.fillText(i,t*fontSize,a),a>canvas.height&&(drawnToBottom=!0),(!drawnToBottom&&.925<Math.random()||drawnToBottom&&.95<Math.random())&&(drops[t]=0),drops[t]++}}window.onresize=function(){initCanvas()},initCanvas(),setInterval(draw,160);var gotoslide=function(e){setSlideContent(notch,linear_nav[e].object_id),$(".slideshow").slickGoTo(parseInt(e))};function setSlideShow(){jQuery(".slideshow").slick({dots:!1,arrows:!0,infinite:!0,speed:1e3,fade:!0,cssEase:"linear",focusoOnSelect:!0,nextArrow:'<i class="slick-arrow slick-next"></i>',prevArrow:'<i class="slick-arrow slick-prev"></i>'}),console.log("set slideshow")}function setSlide(e,n){return e='\n<div><div id="slide'+e+'" data-id="'+n+'" class="slide-wrap">',e+="\n\t<h2></h2>",e+='\n\t<div class="img-wrap"></div>',e+='\n\t<section><div class="content"></div></section>',e+="\n</div></div>\n"}function setSlides(){var e="0",n="";if(null==posts)window.setTimeout(setSlides(),100);else{for(i=0;linear_nav[i];i++)e=linear_nav[i].object_id.toString(),n+=setSlide(i,e);jQuery("#article").html(n)}}jQuery(".slick-dots li button").on("click",function(e){e.stopPropagation()});var $carousel=jQuery(".slideshow");function setSlider(){jQuery("#slider").slider({orientation:orientation,range:"max",min:0,max:linear_nav.length,value:0,slide:function(e,n){setSliderNotch(n.value),console.log("slider",n.value)}})}function setSliderNotch(e){console.log("notch",data_nav[e],e),location.hash=posts[data_nav[e].object_id].slug,console.log("set slider notch",e,location.hash),jQuery("#slider").slider("value",e),null!=linear_nav[e]&&(setContent(e,data_nav[e].object_id,data_nav[e].object_id),triggerWheelNav(e))}jQuery(document).on("keydown",function(e){37==e.keyCode&&$carousel.slick("slickPrev"),39==e.keyCode&&$carousel.slick("slickNext")}),jQuery("a[data-slide]").click(function(e){e.preventDefault();var n=jQuery(this).data("slide");setSlideContent(notch,linear_nav[n].object_id)}),jQuery;var camera,scene,renderer,stars=[];function init(){(camera=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,1e3)).position.z=5,scene=new THREE.Scene,(renderer=new THREE.WebGLRenderer).setSize(window.innerWidth,window.innerHeight),jQuery("#stars").append(renderer.domElement)}function addSphere(){for(var e=-1e3;e<1e3;e+=20){var n=new THREE.SphereGeometry(.5,32,32),t=new THREE.MeshBasicMaterial({color:16777215}),i=new THREE.Mesh(n,t);i.position.x=1e3*Math.random()-500,i.position.y=1e3*Math.random()-500,i.position.z=e,i.scale.x=i.scale.y=2,scene.add(i),stars.push(i)}}function animateStars(){for(var e=0;e<stars.length;e++)star=stars[e],star.position.z+=e/10,1e3<star.position.z&&(star.position.z-=2e3)}function render(){requestAnimationFrame(render),renderer.render(scene,camera),animateStars()}init(),addSphere(),render(),jQuery(window).on("resize",function(){renderer.setSize(window.innerWidth,window.innerHeight)});var menu_config={"top-menu":{menu_type:"wheel",location:"#outer-nav",_p:{maxPercent:1,min:.91,max:1,sel_min:.91,sel_max:1}}},inner_nav_params={maxPercent:1,min:.91,max:1,sel_min:.91,sel_max:1},inner_subnav_params={maxPercent:1,min:.9,max:1,sel_min:.9,sel_max:1},last_outer_notch=0,last_inner_notch=0,menu_raphael={},wheels={};function makeWheelNav(e,n,t){"outer-nav"==e?(child_dest="inner-nav",child_params=inner_nav_params):"inner-nav"==e&&(child_dest="inner-subnav",child_params=inner_subnav_params);var i=[],a=[];for(wheels[e]=new wheelnav(e),wheels[e].spreaderEnable=!1,wheels[e].cssMode=!0,wheels[e].navAngle=270,wheels[e].selectedNavItem=2,wheels[e].selectedNavItemIndex=null,wheels[e].maxPercent=t.maxPercent,wheels[e].slicePathFunction=slicePath().DonutSlice,wheels[e].slicePathCustom=slicePath().PieSliceCustomization(),wheels[e].slicePathCustom.minRadiusPercent=t.min,wheels[e].slicePathCustom.maxRadiusPercent=t.max,wheels[e].sliceSelectedPathCustom=slicePath().PieSliceCustomization(),wheels[e].sliceSelectedPathCustom.minRadiusPercent=t.sel_min,wheels[e].sliceSelectedPathCustom.maxRadiusPercent=t.sel_max,wheels[e].titleSelectedAttr={},l=0;l<n.length;l++)i.push(n[l].title),a.push(n[l].id);wheels[e].initWheel(i);var r=360/wheels[e].navItemCount,s=90;for(l=0;l<wheels[e].navItemCount;l++)wheels[e].navItems[l].titleRotateAngle=s,s=r+(90-r);"outer-nav"==e&&0<n[0].children.length&&makeWheelNav("inner-nav",n[0].children,inner_nav_params),wheels[e].createWheel();for(var l=counter=0;l<wheels[e].navItemCount;l++)wheels[e].navItems[l].data=n[l],wheels[e].navItems[l].navigateFunction=function(){jQuery("#slider").slider("option","value",this.data.notch),"inner-subnav"!=e&&(0<this.data.children.length?(popAWheelie(e),setSliderNotch(slug_nav[this.data.slug])):popAWheelie(e)),setContent(child_dest,this.data.object_id,this.data.object)};menu_raphael[e]=wheels[e].raphael,reposition_screen()}function triggerWheelNav(e){var n=data_nav[e],t=n.dest;console.log("trigger wheel, notch:",n," | dest:",t),"outer-nav"==t?(null!=wheels["inner-nav"]&&wheels[t].navigateWheel(n.slice),popAWheelie("inner-nav"),0<n.children.length&&makeWheelNav("inner-nav",n.children,inner_nav_params),last_outer_notch=e):"inner-nav"==t?(last_outer_notch!=n.parent?(wheels["outer-nav"].navigateWheel(data_nav[n.parent].slice),makeWheelNav("inner-nav",data_nav[n.parent].children,inner_nav_params),wheels[t].navigateWheel(n.slice),last_outer_notch=n.parent):(wheels["outer-nav"].navigateWheel(data_nav[n.parent].slice),null!=wheels["inner-nav"]?(console.log("same parent"),wheels[t].navigateWheel(n.slice),null!=wheels["inner-subnav"]&&wheels["inner-subnav"].raphael.remove()):(makeWheelNav("inner-nav",data_nav[n.parent].children,inner_nav_params),wheels[t].navigateWheel(n.slice)),0<n.children.length?makeWheelNav("inner-subnav",n.children,inner_nav_params):popAWheelie("inner-subnav")),last_inner_notch=e):"inner-subnav"==t&&(last_outer_notch!=n.grandparent&&(wheels["outer-nav"].navigateWheel(data_nav[n.grandparent].slice),last_outer_notch=n.grandparent),last_inner_notch!=n.parent?(console.log("where have I gone wrong?",n),wheels["inner-nav"].navigateWheel(data_nav[n.parent].slice),makeWheelNav("inner-subnav",data_nav[n.parent].children,inner_nav_params),wheels["inner-subnav"].navigateWheel(n.slice),last_inner_notch=n.parent):null==wheels["inner-subnav"]?makeWheelNav("inner-subnav",n.children,inner_nav_params):wheels[t].navigateWheel(n.slice)),last_dest=t}function popAWheelie(e){"outer-nav"==e?null!=wheels["inner-nav"]&&(wheels["inner-nav"].raphael.remove(),null!=wheels["inner-subnav"]&&wheels["inner-subnav"].raphael.remove()):"inner-nav"==e&&null!=wheels["inner-subnav"]&&wheels["inner-subnav"].raphael.remove()}