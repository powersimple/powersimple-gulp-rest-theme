var menu_config={"top-menu":{menu_type:"wheel",location:"#outer-nav",_p:{maxPercent:1,min:.9,max:1,sel_min:.9,sel_max:1}}},inner_nav_params={maxPercent:1,min:.82,max:1,sel_min:.82,sel_max:1},increment="vw",_w=jQuery(window).width(),_h=jQuery(window).height();function reposition_screen(){_h<_w?(jQuery(".phi-centered").css("width","61.8vh"),jQuery(".phi-centered").css("height","61.8vh"),jQuery(".phi-centered").css("margin-left","-30.9vh"),jQuery(".phi-centered").css("margin-top","-30.9vh"),jQuery("#main-nav").css("width","80vh"),jQuery("#main-nav").css("height","80vh"),jQuery("#main-nav").css("margin-left","-40vh"),jQuery("#main-nav").css("margin-top","-40vh")):(jQuery(".phi-centered").css("width","61.8vw"),jQuery(".phi-centered").css("height","61.8vw"),jQuery(".phi-centered").css("margin-left","-29.9vw"),jQuery(".phi-centered").css("margin-top","-30.9vw"),jQuery("#main-nav").css("width","80vw"),jQuery("#main-nav").css("height","80vw"),jQuery("#main-nav").css("margin-left","-40vw"),jQuery("#main-nav").css("margin-top","-40vw")),jQuery("#stars").css("height","100vh"),jQuery("#stars").css("width","100vw")}function circleMenu(e){for(var t=document.querySelectorAll(e),i=0,s=t.length;i<s;i++){var n=Math.cos(-.5*Math.PI-1/s*2*i*Math.PI);t[i].style.left=50-36*n+increment;var a=Math.sin(-.5*Math.PI-1/s*2*i*Math.PI);t[i].style.top=50+35*a+increment}document.querySelector(".menu-button").onclick=function(e){e.preventDefault(),document.querySelector(".circle").classList.toggle("open")}}function setContent(e,t){"category"==t?console.log("set_content cat",categories[e]):null!=posts[e]&&(console.log("set_content post",posts[e]),jQuery("#page-title").html(posts[e].title),jQuery("#content").html(posts[e].content))}function displayPage(e,t){var s="";if(0<t.length){for(s="<ul class='nav_project'>",i=0;i<post_ids.length;i++)displayProjectCard(t[i]);s+="</ul>"}jQuery("#project-nav").html(s)}function displayPosts(e,t){if(0<t.length){for("<ul class='nav_project'>",i=0;i<post_ids.length;i++)displayProjectCard(t[i]);"</ul>"}}function displayProjects(e,t){var s="";if(0<t.length){for(type=data[i].type,t[data[i].id]=data[i],s="<ul class='nav_project'>",i=0;i<post_ids.length;i++)displayProjectCard(t[i]);s+="</ul>"}jQuery("#project-nav").html(s)}function displayProjectCard(e){var t='<li class="project-card">';return t+=posts[e].title,t+="</li>"}function menu_order(e,t){return e.menu_order<t.menu?-1:e.menu_order>t.menu_order?1:0}function displayMenus(){var e=[];for(var t in menus)if(null!=menu_config[t]){for(var i in menu_array=[],menus[t].items)0==menus[t].items[i].parent&&menu_array.push(menus[t].items[i]);menu_array.sort(menu_order);for(var s=[],n=0;n<menu_array.length;n++){s=[];for(var a=0;a<menu_array[n].children.length;a++)s.push({title:menus[t].items[menu_array[n].children[a]].title,id:menus[t].items[menu_array[n].children[a]].id,object:menus[t].items[menu_array[n].children[a]].object,object_id:menus[t].items[menu_array[n].children[a]].object_id,children:menus[t].items[menu_array[n].children[a]].children});e.push({title:menu_array[n].title,id:menu_array[n].id,object:menu_array[n].object,object_id:menu_array[n].object_id,children:s})}jQuery(menu_config[t].location).html(""),"wheel"==menu_config[t].menu_type&&makeWheelNav("outer-nav",e,menu_config[t]._p)}}function displayTags(e,t){for(var i in t);}function displayCategories(e,t){var i="<ul class='nav_cat'>";for(var s in t)i+=navTab(t[s]);i+="</ul>",jQuery(e).html(i)}jQuery(document).ready(function(){reposition_screen()}),jQuery(window).resize(function(){_w=jQuery(window).width(),_h=jQuery(window).height(),increment=_h<_w?"vh":"vw",reposition_screen()}),jQuery("#logo").on("click",function(e){e.preventDefault()}),jQuery("#portfolio").on("click",".nav__item",function(){var e=jQuery(this).data("id");displayProjects(categories[e].category_posts)});var posts={},categories={},tags={},menus={};function getREST(e,t,s,n){var a="/wp-json/wp/v2/"+e;jQuery.ajax({url:a,data:t,success:function(e,t,i){return s(e,n)},error:function(e,t,i){console.log(a,e.responseText)},cache:!1})}function setPosts(e,t){var i="post";if(Array.isArray(e))for(var s=0;s<e.length;s++)void 0!==e[s].title&&void 0!==e[s].title.rendered&&(e[s].title=e[s].title.rendered),void 0!==e[s].content&&void 0!==e[s].content.rendered&&(e[s].content=e[s].content.rendered),void 0!==e[s].type&&(i=e[s].type,posts[e[s].id]=e[s]);else i=e.type,posts[e.id]=e;if(void 0!==i)switch(i){case i="project":case i="post":case i="page":}return posts}function setMenuItem(e){return this_item={},this_item.menu_id=e.ID,this_item.title=e.title,this_item.menu_order=e.menu_order,this_item.object=e.object,this_item.object_id=e.object_id,this_item.parent=e.menu_item_parent,this_item.children=[],this_item}function setMenu(e,t){menu={};for(var i=0;i<t.length;i++)menu[t[i].ID]=setMenuItem(t[i]),0!=t[i].menu_item_parent&&menu[t[i].menu_item_parent].children.push(t[i].ID);return menu}function setMenus(e,t){for(var i=0;i<e.length;i++)menus[e[i].slug]={},menus[e[i].slug].name=e[i].name,menus[e[i].slug].items=setMenu(e[i].slug,e[i].items);setContent(active_id,"page"),displayMenus()}function setChildCategories(e,t){for(var i=0;i<e.length;i++)categories[e[i].id]=e[i];return displayCategories(t,categories),e}function setTags(e,t){for(var i=0;i<e.length;i++)tags[e[i].id]=e[i];return displayTags(t,tags),e}function navTab(e){var t="";return t+="<li data-id="+e.id+" class='nav__item'>",t+="<span>",t+=e.name,t+="</span>",t+="</li>"}getREST("posts","fields=id,type,title,content,slug,excerpt,thumbnail_url,project_info,thumbnail_versions,featured_video,type",setPosts,"#posts"),getREST("pages/"+home_page,"fields=id,type,title,content,slug,excerpt,thumbnail_url,project_info,thumbnail_versions,featured_video,type",setPosts,"#pages"),getREST("pages","fields=id,type,title,content,slug,excerpt,thumbnail_url,project_info,thumbnail_versions,featured_video,type",setPosts,"#pages"),getREST("project","fields=id,type,title,content,slug,excerpt,thumbnail_url,project_info,thumbnail_versions,featured_videotype",setPosts,"#projects"),getREST("categories","parent=19&fields=id,name,count,slug,description,category_posts",setChildCategories,"#category-menu"),getREST("tags","fields=id,name,slug,tag_posts",setTags,"tags"),getREST("menus","",setMenus,"#main-menu"),function(a){"use strict";var o,r;(o=function(e,t,i,s){this.obj=e,this.options=e.options,this.name=t,this.href=s.href,s.url&&(this.url=s.url),this.el=a('<a href="'+this.href+'">'+this.name+"</a>").addClass("node"),a("body").prepend(this.el),i?e.lines[e.lines.length]=new r(e,this,i):(e.activeNode=this).el.addClass("active root"),this.parent=i,this.children=[],this.parent&&this.parent.children.push(this),this.moving=!1,this.moveTimer=0,this.obj.movementStopped=!1,this.visible=!0,this.x=1,this.y=1,this.dx=0,this.dy=0,this.hasPosition=!1,this.content=[],this.el.css("position","absolute");var n=this;this.el.draggable({drag:function(){e.root.animateToStatic()}}),this.el.click(function(){return e.activeNode&&(e.activeNode.el.removeClass("active"),e.activeNode.parent&&e.activeNode.parent.el.removeClass("activeparent")),"function"==typeof s.onclick&&s.onclick(n),e.activeNode=n,e.activeNode.el.addClass("active"),e.activeNode.parent&&e.activeNode.parent.el.addClass("activeparent"),e.root.animateToStatic(),!1})}).prototype.animateToStatic=function(){clearTimeout(this.moveTimer);var e=this;this.moveTimer=setTimeout(function(){e.obj.movementStopped=!0},4e3),this.moving||(this.moving=!0,this.obj.movementStopped=!1,this.animateLoop())},o.prototype.animateLoop=function(){var e,t,i=this;for(this.obj.canvas.clear(),e=0,t=this.obj.lines.length;e<t;e++)this.obj.lines[e].updatePosition();this.findEquilibrium()||this.obj.movementStopped?this.moving=!1:setTimeout(function(){i.animateLoop()},10)},o.prototype.findEquilibrium=function(){var e,t,i=!0;for(i=this.display()&&i,e=0,t=this.children.length;e<t;e++)i=this.children[e].findEquilibrium()&&i;return i},o.prototype.display=function(t){var i,s,n=this;return t=t||0,this.visible?this.obj.activeNode!==this&&this.obj.activeNode!==this.parent&&this.obj.activeNode.parent!==this&&(this.el.hide(),this.visible=!1):this.obj.activeNode!==this&&this.obj.activeNode!==this.parent&&this.obj.activeNode.parent!==this||(this.el.show(),this.visible=!0),this.drawn=!0,this.hasPosition||(this.x=this.options.mapArea.x/2,this.y=this.options.mapArea.y/2,this.el.css({left:this.x+"px",top:this.y+"px"}),this.hasPosition=!0),i=2*Math.PI/this.children.length,a.each(this.children,function(e){this.hasPosition||(!this.options.showProgressive||t<=1)&&(s=e*i,this.x=50*Math.cos(s)+n.x,this.y=50*Math.sin(s)+n.y,this.hasPosition=!0,this.el.css({left:this.x+"px",top:this.y+"px"}))}),this.updatePosition()},o.prototype.updatePosition=function(){var e,t,i;return this.el.hasClass("ui-draggable-dragging")?(this.x=parseInt(this.el.css("left"),10)+this.el.width()/2,this.y=parseInt(this.el.css("top"),10)+this.el.height()/2,this.dx=0,this.dy=0,!1):(e=this.getForceVector(),this.dx+=e.x*this.options.timeperiod,this.dy+=e.y*this.options.timeperiod,this.dx=this.dx*this.options.damping,this.dy=this.dy*this.options.damping,Math.abs(this.dx)<this.options.minSpeed&&(this.dx=0),Math.abs(this.dy)<this.options.minSpeed&&(this.dy=0),Math.abs(this.dx)+Math.abs(this.dy)===0||(this.x+=this.dx*this.options.timeperiod,this.y+=this.dy*this.options.timeperiod,this.x=Math.min(this.options.mapArea.x,Math.max(1,this.x)),this.y=Math.min(this.options.mapArea.y,Math.max(1,this.y)),t=this.x-this.el.width()/2,i=this.y-this.el.height()/2-10,this.el.css({left:t+"px",top:i+"px"}),!1))},o.prototype.getForceVector=function(){var e,t,i,s,n,a,o,r,h,l,c,d=0,u=0,p=this.obj.nodes,m=this.obj.lines;for(e=0;e<p.length;e++)p[e]!==this&&p[e].visible&&(t=p[e].x-this.x,i=p[e].y-this.y,n=Math.sqrt(t*t+i*i),Math.abs(n)<500&&(0===t?(a=Math.PI/2,s=0):(a=Math.atan(i/t),s=t/Math.abs(t)),d+=-(o=500*this.options.repulse/(n*n))*Math.cos(a)*s,u+=-o*Math.sin(a)*s));for(r=this.x+this.el.width(),o=500*this.options.wallrepulse/(r*r),d+=Math.min(2,o),h=this.options.mapArea.x-r,o=-500*this.options.wallrepulse/(h*h),d+=Math.max(-2,o),o=500*this.options.wallrepulse/(this.y*this.y),u+=Math.min(2,o),l=this.options.mapArea.y-this.y,o=-500*this.options.wallrepulse/(l*l),u+=Math.max(-2,o),e=0;e<m.length;e++){if(c=null,m[e].start===this)c=m[e].end;else{if(m[e].end!==this)continue;c=m[e].start}c.visible&&(t=c.x-this.x,i=c.y-this.y,n=Math.sqrt(t*t+i*i),0<Math.abs(n)&&(0===t?(a=Math.PI/2,s=0):(a=Math.atan(i/t),s=t/Math.abs(t)),d+=(o=this.options.attract*n/1e4)*Math.cos(a)*s,u+=o*Math.sin(a)*s))}return this.obj.activeNode===this&&(t=(c=this.options.mapArea).x/2-this.options.centreOffset-this.x,i=c.y/2-this.y,n=Math.sqrt(t*t+i*i),0<Math.abs(n)&&(0===t?(a=Math.PI/2,s=0):(s=t/Math.abs(t),a=Math.atan(i/t)),d+=(o=.1*this.options.attract*n*3/1e3)*Math.cos(a)*s,u+=o*Math.sin(a)*s)),Math.abs(d)>this.options.maxForce&&(d=this.options.maxForce*(d/Math.abs(d))),Math.abs(u)>this.options.maxForce&&(u=this.options.maxForce*(u/Math.abs(u))),{x:d,y:u}},o.prototype.removeNode=function(){var e,t=this.obj.nodes,i=this.obj.lines;for(e=0;e<this.children.length;e++)this.children[e].removeNode();for(this.obj.nodes=[],e=0;e<t.length;e++)t[e]!==this&&this.obj.nodes.push(t[e]);for(this.obj.lines=[],e=0;e<i.length;e++)i[e].start!==this&&i[e].end!==this&&this.obj.lines.push(i[e]);this.el.remove()},(r=function(e,t,i){this.obj=e,this.options=e.options,this.start=t,this.colour="blue",this.size="thick",this.end=i}).prototype.updatePosition=function(){(this.options.showSublines||this.start.visible&&this.end.visible)&&(this.size=this.start.visible&&this.end.visible?"thick":"thin",this.color=this.obj.activeNode.parent===this.start||this.obj.activeNode.parent===this.end?"red":"blue",this.strokeStyle="#FFF",this.obj.canvas.path("M"+this.start.x+" "+this.start.y+"L"+this.end.x+" "+this.end.y).attr({stroke:this.strokeStyle,opacity:.2,"stroke-width":"5px"}))},a.fn.addNode=function(e,t,i){var s=this[0],n=s.nodes[s.nodes.length]=new o(s,t,e,i);return console.log(s.root),s.root.animateToStatic(),n},a.fn.addRootNode=function(e,t){var i=this[0].nodes[0]=new o(this[0],e,null,t);return this[0].root=i},a.fn.removeNode=function(e){return this.each(function(){})},a.fn.mindmap=function(e){e=a.extend({attract:15,repulse:6,damping:.55,timeperiod:10,wallrepulse:.4,mapArea:{x:-1,y:-1},canvasError:"alert",minSpeed:.05,maxForce:.1,showSublines:!1,updateIterationCount:20,showProgressive:!0,centreOffset:100,timer:0},e);var t=a(window);return this.each(function(){var n=this;this.mindmapInit=!0,this.nodes=[],this.lines=[],this.activeNode=null,this.options=e,this.animateToStatic=function(){this.root.animateToStatic()},t.resize(function(){n.animateToStatic()}),-1===e.mapArea.x&&(e.mapArea.x=t.width()),-1===e.mapArea.y&&(e.mapArea.y=t.height()),this.canvas=Raphael(0,0,e.mapArea.x,e.mapArea.y),a(this).addClass("js-mindmap-active"),a(this).keyup(function(e){var t,i,s=n.activeNode.parent;switch(e.which){case 33:case 38:s&&s.el.click();break;case 13:case 34:case 40:n.activeNode.children.length&&n.activeNode.children[0].el.click();break;case 37:if(s){if(t=null,s.children[0]===n.activeNode)t=s.children[s.children.length-1];else for(i=1;i<s.children.length;i++)s.children[i]===n.activeNode&&(t=s.children[i-1]);t&&t.el.click()}break;case 39:if(s){if(t=null,s.children[s.children.length-1]===n.activeNode)t=s.children[0];else for(i=s.children.length-2;0<=i;i--)s.children[i]===n.activeNode&&(t=s.children[i+1]);t&&t.el.click()}}return!1})})}}(jQuery);var camera,scene,renderer,stars=[];function init(){(camera=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,1e3)).position.z=5,scene=new THREE.Scene,(renderer=new THREE.WebGLRenderer).setSize(window.innerWidth,window.innerHeight),jQuery("#stars").append(renderer.domElement)}function addSphere(){for(var e=-1e3;e<1e3;e+=20){var t=new THREE.SphereGeometry(.5,32,32),i=new THREE.MeshBasicMaterial({color:16777215}),s=new THREE.Mesh(t,i);s.position.x=1e3*Math.random()-500,s.position.y=1e3*Math.random()-500,s.position.z=e,s.scale.x=s.scale.y=2,scene.add(s),stars.push(s)}}function animateStars(){for(var e=0;e<stars.length;e++)star=stars[e],star.position.z+=e/10,1e3<star.position.z&&(star.position.z-=2e3)}function render(){requestAnimationFrame(render),renderer.render(scene,camera),animateStars()}init(),addSphere(),render(),jQuery(window).on("resize",function(){renderer.setSize(window.innerWidth,window.innerHeight)});var menu_raphael={},wheels={};function makeWheelNav(e,t,i){console.log(i);var s=[],n=[];for(wheels[e]=new wheelnav(e),wheels[e].spreaderEnable=!1,wheels[e].cssMode=!0,wheels[e].maxPercent=i.maxPercent,wheels[e].slicePathFunction=slicePath().DonutSlice,wheels[e].slicePathCustom=slicePath().PieSliceCustomization(),wheels[e].slicePathCustom.minRadiusPercent=i.min,wheels[e].slicePathCustom.maxRadiusPercent=i.max,wheels[e].sliceSelectedPathCustom=slicePath().PieSliceCustomization(),wheels[e].sliceSelectedPathCustom.minRadiusPercent=i.sel_min,wheels[e].sliceSelectedPathCustom.maxRadiusPercent=i.sel_max,wheels[e].titleSelectedAttr={},r=0;r<t.length;r++)s.push(t[r].title),n.push(t[r].id);wheels[e].initWheel(s);var a=360/wheels[e].navItemCount,o=90;for(r=0;r<wheels[e].navItemCount;r++)wheels[e].navItems[r].titleRotateAngle=o,o=a+(90-a);wheels[e].createWheel();for(var r=counter=0;r<wheels[e].navItemCount;r++)wheels[e].navItems[r].data=t[r],type=t[r].type,posts[t[r].id]=t[r],wheels[e].navItems[r].navigateFunction=function(){0<this.data.children.length?makeWheelNav("inner-nav",this.data.children,inner_nav_params):null!=wheels["inner-nav"]&&console.log("wheels2",wheels["inner-nav"].raphael.remove()),setContent(this.data.object_id,this.data.object)};menu_raphael[e]=wheels[e].raphael}window.onload=function(){};